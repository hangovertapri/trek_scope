(()=>{var e={};e.id=957,e.ids=[957],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},19573:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>o});var s=a(60687),r=a(43210),i=a(16189),l=a(99208),n=a(85814),d=a.n(n);function o(){(0,i.useRouter)();let{data:e,status:t}=(0,l.wV)(),[a,n]=(0,r.useState)([]),[o,c]=(0,r.useState)(!1),[m,u]=(0,r.useState)({name:"",slug:"",region:"",difficulty:"Moderate",duration:1,price_min:0,price_max:0,images:[],videoUrl:"",agencyId:""}),[x,p]=(0,r.useState)(null),[g,h]=(0,r.useState)({}),[b,f]=(0,r.useState)([]),[y,v]=(0,r.useState)([]);async function j(e,t=!1){let a=e.target.files;if(a)for(let e=0;e<a.length;e++){let s=a[e];if(!s.type.startsWith("image/")){alert("Please select valid image files");continue}let r=new FileReader;r.onload=e=>{let a=e.target?.result;t?h(e=>({...e,images:[...e.images||[],a]})):u(e=>({...e,images:[...e.images,a]}))},r.readAsDataURL(s)}}function N(e,t=!1){t?h(t=>({...t,images:(t.images||[]).filter((t,a)=>a!==e)})):u(t=>({...t,images:t.images.filter((t,a)=>a!==e)}))}async function w(){c(!0);let e=await fetch("/api/treks");n(await e.json()),c(!1)}async function _(e){e.preventDefault();let t={name:m.name,slug:m.slug,region:m.region,difficulty:m.difficulty,duration:Number(m.duration),price_range:[Number(m.price_min),Number(m.price_max)],altitude:0,best_season:[],permit_required:!1,highlights:[],itinerary:[],images:m.images.length>0?m.images:["default-trek"],safety_tips:[],map_embed_url:m.videoUrl||"",description:"",overview:"",faq:[],agencyId:m.agencyId||void 0};(await fetch("/api/treks",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).ok?(await w(),u({name:"",slug:"",region:"",difficulty:"Moderate",duration:1,price_min:0,price_max:0,images:[],videoUrl:"",agencyId:""})):alert("Failed to add trek")}function k(){p(null),h({})}async function C(e){if(e.preventDefault(),!x)return;let t={};void 0!==g.name&&(t.name=g.name),void 0!==g.slug&&(t.slug=g.slug),void 0!==g.region&&(t.region=g.region),void 0!==g.difficulty&&(t.difficulty=g.difficulty),void 0!==g.duration&&(t.duration=Number(g.duration)),(void 0!==g.price_min||void 0!==g.price_max)&&(t.price_range=[Number(g.price_min??0),Number(g.price_max??0)]),void 0!==g.images&&(t.images=g.images),void 0!==g.videoUrl&&(t.map_embed_url=g.videoUrl),(await fetch("/api/treks",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:x,patch:t})})).ok?(await w(),k()):alert("Update failed")}async function U(e){confirm("Delete this trek?")&&((await fetch("/api/treks",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e})})).ok?await w():alert("Delete failed"))}return"loading"===t?(0,s.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,s.jsx)("p",{className:"text-center",children:"Loading..."})}):(0,s.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-8",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-3xl font-bold",children:"Admin Dashboard"}),(0,s.jsx)("p",{className:"text-muted-foreground",children:"Manage treks and agencies"})]}),(0,s.jsxs)("div",{className:"flex gap-3",children:[(0,s.jsx)(d(),{href:"/admin/agencies",className:"px-4 py-2 rounded bg-primary text-primary-foreground hover:bg-primary/90 font-medium",children:"\uD83D\uDCCA View Agencies"}),(0,s.jsx)("button",{onClick:function(){(0,l.CI)({callbackUrl:"/admin/login",redirect:!0})},className:"px-4 py-2 rounded bg-muted text-muted-foreground hover:bg-muted/90",children:"Logout"})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,s.jsxs)("div",{className:"col-span-1 bg-card p-4 rounded",children:[(0,s.jsx)("h2",{className:"font-semibold mb-3",children:"Add Trek"}),(0,s.jsxs)("form",{onSubmit:_,className:"space-y-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Trek Name *"}),(0,s.jsx)("input",{placeholder:"e.g., Everest Base Camp",value:m.name,onChange:e=>u({...m,name:e.target.value}),className:"w-full border rounded px-2 py-1 bg-white text-gray-900 placeholder:text-gray-400",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Slug (URL-friendly) *"}),(0,s.jsx)("input",{placeholder:"e.g., everest-base-camp",value:m.slug,onChange:e=>u({...m,slug:e.target.value}),className:"w-full border rounded px-2 py-1 bg-white text-gray-900 placeholder:text-gray-400",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Region *"}),(0,s.jsx)("input",{placeholder:"e.g., Khumbu",value:m.region,onChange:e=>u({...m,region:e.target.value}),className:"w-full border rounded px-2 py-1 bg-white text-gray-900 placeholder:text-gray-400",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Difficulty Level *"}),(0,s.jsxs)("select",{value:m.difficulty,onChange:e=>u({...m,difficulty:e.target.value}),className:"w-full border rounded px-2 py-1 bg-white text-gray-900",children:[(0,s.jsx)("option",{value:"Easy",children:"Easy"}),(0,s.jsx)("option",{value:"Moderate",children:"Moderate"}),(0,s.jsx)("option",{value:"Challenging",children:"Challenging"}),(0,s.jsx)("option",{value:"Expert",children:"Expert"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Duration (days) *"}),(0,s.jsx)("input",{type:"number",placeholder:"e.g., 14",value:m.duration,onChange:e=>u({...m,duration:Number(e.target.value)}),className:"w-full border rounded px-2 py-1 bg-white text-gray-900 placeholder:text-gray-400",required:!0,min:"1"})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Min Price (USD)"}),(0,s.jsx)("input",{type:"number",placeholder:"e.g., 1200",value:m.price_min,onChange:e=>u({...m,price_min:Number(e.target.value)}),className:"w-full border rounded px-2 py-1 bg-white text-gray-900 placeholder:text-gray-400",min:"0"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Max Price (USD)"}),(0,s.jsx)("input",{type:"number",placeholder:"e.g., 1800",value:m.price_max,onChange:e=>u({...m,price_max:Number(e.target.value)}),className:"w-full border rounded px-2 py-1 bg-white text-gray-900 placeholder:text-gray-400",min:"0"})]})]}),(0,s.jsxs)("div",{className:"border-t pt-3 mt-3",children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Upload Images"}),(0,s.jsx)("input",{type:"file",multiple:!0,accept:"image/*",onChange:e=>j(e,!1),className:"w-full border rounded px-2 py-1 bg-white text-gray-900 text-sm cursor-pointer"}),m.images.length>0&&(0,s.jsxs)("div",{className:"mt-3 space-y-2",children:[(0,s.jsxs)("p",{className:"text-xs font-medium",children:["Uploaded Images (",m.images.length,"):"]}),(0,s.jsx)("div",{className:"grid grid-cols-2 gap-2",children:m.images.map((e,t)=>(0,s.jsxs)("div",{className:"relative bg-gray-100 rounded overflow-hidden",children:[(0,s.jsx)("img",{src:e,alt:`Preview ${t+1}`,className:"w-full h-20 object-cover"}),(0,s.jsx)("button",{type:"button",onClick:()=>N(t,!1),className:"absolute top-1 right-1 bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs hover:bg-red-600",children:"✕"})]},t))})]}),(0,s.jsxs)("div",{className:"mt-3 pt-3 border-t",children:[(0,s.jsx)("label",{className:"block text-xs font-medium mb-2",children:"Or add image URLs manually"}),(0,s.jsx)("textarea",{placeholder:"https://example.com/image1.jpg, https://example.com/image2.jpg",value:m.images.filter(e=>!e.startsWith("data:")).join(", "),onChange:e=>{let t=e.target.value.split(",").map(e=>e.trim()).filter(Boolean),a=m.images.filter(e=>e.startsWith("data:"));u({...m,images:[...a,...t]})},className:"w-full border rounded px-2 py-1 bg-white text-gray-900 placeholder:text-gray-400 text-xs h-12"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Video URL"}),(0,s.jsx)("input",{type:"url",placeholder:"https://www.youtube.com/embed/...",value:m.videoUrl,onChange:e=>u({...m,videoUrl:e.target.value}),className:"w-full border rounded px-2 py-1 bg-white text-gray-900 placeholder:text-gray-400"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Assign to Agency (Optional)"}),(0,s.jsx)("input",{type:"text",placeholder:"e.g., agency-1 (leave empty for admin-managed trek)",value:m.agencyId,onChange:e=>u({...m,agencyId:e.target.value}),className:"w-full border rounded px-2 py-1 bg-white text-gray-900 placeholder:text-gray-400 text-sm"}),(0,s.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Agencies can only edit their own treks. Admins can edit all."})]}),(0,s.jsx)("div",{className:"flex justify-end",children:(0,s.jsx)("button",{type:"submit",className:"px-3 py-1 bg-accent text-white rounded",children:"Add"})})]})]}),(0,s.jsxs)("div",{className:"lg:col-span-2 bg-card p-4 rounded",children:[(0,s.jsx)("h2",{className:"font-semibold mb-3",children:"Treks"}),o?(0,s.jsx)("p",{children:"Loading…"}):(0,s.jsx)("ul",{className:"space-y-3",children:a.map(e=>(0,s.jsxs)("li",{className:"flex items-center justify-between border-b py-2",children:[(0,s.jsx)("div",{className:"flex-1",children:x===e.id?(0,s.jsxs)("form",{onSubmit:C,className:"space-y-2",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-xs font-medium",children:"Trek Name"}),(0,s.jsx)("input",{value:g.name??"",onChange:e=>h({...g,name:e.target.value}),className:"w-full border rounded px-2 py-1 bg-white text-gray-900 text-sm mt-1"})]}),(0,s.jsxs)("div",{className:"grid grid-cols-3 gap-2",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-xs font-medium",children:"Region"}),(0,s.jsx)("input",{value:g.region??"",onChange:e=>h({...g,region:e.target.value}),className:"w-full border rounded px-2 py-1 bg-white text-gray-900 text-sm mt-1"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-xs font-medium",children:"Difficulty"}),(0,s.jsxs)("select",{value:g.difficulty??"Moderate",onChange:e=>h({...g,difficulty:e.target.value}),className:"w-full border rounded px-2 py-1 bg-white text-gray-900 text-sm mt-1",children:[(0,s.jsx)("option",{value:"Easy",children:"Easy"}),(0,s.jsx)("option",{value:"Moderate",children:"Moderate"}),(0,s.jsx)("option",{value:"Challenging",children:"Challenging"}),(0,s.jsx)("option",{value:"Expert",children:"Expert"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-xs font-medium",children:"Duration (days)"}),(0,s.jsx)("input",{type:"number",value:g.duration??1,onChange:e=>h({...g,duration:Number(e.target.value)}),className:"w-full border rounded px-2 py-1 bg-white text-gray-900 text-sm mt-1"})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-xs font-medium",children:"Min Price (USD)"}),(0,s.jsx)("input",{type:"number",value:g.price_min??0,onChange:e=>h({...g,price_min:Number(e.target.value)}),className:"w-full border rounded px-2 py-1 bg-white text-gray-900 text-sm mt-1"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-xs font-medium",children:"Max Price (USD)"}),(0,s.jsx)("input",{type:"number",value:g.price_max??0,onChange:e=>h({...g,price_max:Number(e.target.value)}),className:"w-full border rounded px-2 py-1 bg-white text-gray-900 text-sm mt-1"})]})]}),(0,s.jsxs)("div",{className:"border-t pt-2 mt-2",children:[(0,s.jsx)("label",{className:"text-xs font-medium",children:"Upload Images"}),(0,s.jsx)("input",{type:"file",multiple:!0,accept:"image/*",onChange:e=>j(e,!0),className:"w-full border rounded px-2 py-1 bg-white text-gray-900 text-xs cursor-pointer mt-1"}),g.images&&g.images.length>0&&(0,s.jsxs)("div",{className:"mt-2 space-y-1",children:[(0,s.jsxs)("p",{className:"text-xs font-medium",children:["Images (",g.images.length,"):"]}),(0,s.jsx)("div",{className:"grid grid-cols-3 gap-1",children:g.images.map((e,t)=>(0,s.jsxs)("div",{className:"relative bg-gray-100 rounded overflow-hidden",children:[(0,s.jsx)("img",{src:e,alt:`Preview ${t+1}`,className:"w-full h-12 object-cover"}),(0,s.jsx)("button",{type:"button",onClick:()=>N(t,!0),className:"absolute top-0 right-0 bg-red-500 text-white rounded-full w-5 h-5 flex items-center justify-center text-xs hover:bg-red-600",children:"✕"})]},t))})]}),(0,s.jsxs)("div",{className:"mt-2 pt-2 border-t",children:[(0,s.jsx)("label",{className:"text-xs font-medium",children:"Or add URLs"}),(0,s.jsx)("textarea",{value:(g.images||[]).filter(e=>!e.startsWith("data:")).join(", "),onChange:e=>{let t=e.target.value.split(",").map(e=>e.trim()).filter(Boolean),a=(g.images||[]).filter(e=>e.startsWith("data:"));h({...g,images:[...a,...t]})},className:"w-full border rounded px-2 py-1 bg-white text-gray-900 text-xs h-10 mt-1",placeholder:"URL1, URL2"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-xs font-medium",children:"Video URL"}),(0,s.jsx)("input",{type:"url",value:g.videoUrl??"",onChange:e=>h({...g,videoUrl:e.target.value}),className:"w-full border rounded px-2 py-1 bg-white text-gray-900 text-xs mt-1",placeholder:"https://..."})]}),(0,s.jsxs)("div",{className:"flex gap-2 justify-end",children:[(0,s.jsx)("button",{type:"button",onClick:k,className:"px-2 py-1 bg-gray-200 rounded",children:"Cancel"}),(0,s.jsx)("button",{type:"submit",className:"px-2 py-1 bg-green-600 text-white rounded",children:"Save"})]})]}):(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-medium",children:e.name}),(0,s.jsxs)("div",{className:"text-sm text-muted-foreground",children:[e.region," • ",e.difficulty," • ",e.duration," days"]}),e.agencyId&&(0,s.jsxs)("div",{className:"text-xs text-blue-600 mt-1",children:["\uD83C\uDFE2 Agency: ",e.agencyId]})]})}),(0,s.jsx)("div",{className:"flex gap-2 ml-4",children:x!==e.id&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("button",{onClick:()=>{p(e.id),h({name:e.name,slug:e.slug,region:e.region,difficulty:e.difficulty,duration:e.duration,price_min:e.price_range?.[0]??0,price_max:e.price_range?.[1]??0,images:e.images||[],videoUrl:e.map_embed_url||""})},className:"px-2 py-1 bg-blue-500 text-white rounded",children:"Edit"}),(0,s.jsx)("button",{onClick:()=>U(e.id),className:"px-2 py-1 bg-red-500 text-white rounded",children:"Delete"})]})})]},e.id))})]})]})]})}},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},53550:(e,t,a)=>{"use strict";a.r(t),a.d(t,{GlobalError:()=>l.a,__next_app__:()=>m,pages:()=>c,routeModule:()=>u,tree:()=>o});var s=a(65239),r=a(48088),i=a(88170),l=a.n(i),n=a(30893),d={};for(let e in n)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>n[e]);a.d(t,d);let o={children:["",{children:["admin",{children:["dashboard",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,71031)),"C:\\Users\\BUNNY\\Desktop\\trek_scope\\src\\app\\admin\\dashboard\\page.tsx"]}]},{}]},{metadata:{icon:[async e=>(await Promise.resolve().then(a.bind(a,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(a.bind(a,32416)),"C:\\Users\\BUNNY\\Desktop\\trek_scope\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(a.t.bind(a,57398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(a.t.bind(a,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(a.t.bind(a,65284,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(a.bind(a,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]}.children,c=["C:\\Users\\BUNNY\\Desktop\\trek_scope\\src\\app\\admin\\dashboard\\page.tsx"],m={require:a,loadChunk:()=>Promise.resolve()},u=new s.AppPageRouteModule({definition:{kind:r.RouteKind.APP_PAGE,page:"/admin/dashboard/page",pathname:"/admin/dashboard",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},70440:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>r});var s=a(31658);let r=async e=>[{type:"image/x-icon",sizes:"16x16",url:(0,s.fillMetadataSegment)(".",await e.params,"favicon.ico")+""}]},71031:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>s});let s=(0,a(12907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"C:\\\\Users\\\\BUNNY\\\\Desktop\\\\trek_scope\\\\src\\\\app\\\\admin\\\\dashboard\\\\page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\BUNNY\\Desktop\\trek_scope\\src\\app\\admin\\dashboard\\page.tsx","default")},79551:e=>{"use strict";e.exports=require("url")},82843:(e,t,a)=>{Promise.resolve().then(a.bind(a,71031))},93459:(e,t,a)=>{Promise.resolve().then(a.bind(a,19573))}};var t=require("../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),s=t.X(0,[447,21,658,90],()=>a(53550));module.exports=s})();